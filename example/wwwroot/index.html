<!DOCTYPE html>
<head>
    <script src="/cryptour-web-lib.js"></script>
    <script>
        CrypTourWeb.debug = true;
    </script>
</head>
<body style="font-family: Arial">
    <h3>CrypTourWeb Test Site</h1>
    <h4>1. Init CrypTourWeb</h2>
    <button onclick="CrypTourWeb.init()"> Init </button>
    
    <h4>2. Connect Wallet</h4>
    <button onclick="CrypTourWeb.initWallet().then(() => {
        console.log('[HTML] Done')
    })">Connect Wallet</button>

    <h4>3. Create New Dataset</h4>
    Blob: <input type="text" id="blob">  <br/>
    Name: <input type="text" id="Name"> <br/>
    Symbol: <input type="text" id="symbol"> <br/>   
    Cap: <input type="text" id="cap" value="2500000000000000000000"> <br/>
    Mint: <input type="text" id="mint" value="25000000000000000000"> <br/>  
    <button onclick="
        let paramBlob = blob.value;
        let paramName = Name.value;
        let paramSymbol = symbol.value;
        let paramCap = cap.value;
        let paramMint = mint.value;
        CrypTourWeb.createTokenForDataset(paramBlob, paramName, paramSymbol, paramCap, paramMint).then((res) => {
            console.log('[HTML] Token Created')
            console.log(res)
            txid.value = res[0].transactionHash
            token1.value = res[0].events['TokenRegistered'].returnValues.tokenAddress
        })
    ">Create New Dataset</button><br/>
    TransactionID: <input disabled id="txid">
    <h4>4. Create Balancer Pool</h4>
    <button onclick="
        CrypTourWeb.createLP().then((res) => {
            console.log('[HTML] Pool Created')
            console.log(res)
            
            txid2.value = res.transactionHash;
            bpool.value = res.events['LOG_NEW_POOL'].returnValues['pool'];
        })
    ">Create Balancer Pool</button><br />
    TransactionID: <input disabled id="txid2">
    <h4>5. Create Wrapped ETH Token </h4>
    <button onclick="
        let TToken = CrypTourWeb.contracts['TToken'];
        TToken.deploy({ arguments: ['Wrapped ETH', 'WETH', 20,]})
        .send({ from: CrypTourWeb.accounts[0] })
        .then((weth) => {
            wethAddress.value = weth.options.address;
            console.log('[HTML] Created WETH');
            console.log(weth)
            CrypTourWeb.contracts['TToken'] = weth
            return weth.methods.mint(CrypTourWeb.accounts[0], '25000000000000000000').send({ from: CrypTourWeb.accounts[0]});
        }).then(() => {
            console.log('[HTML] Minted WETH');
            token2.value = wethAddress.value;
        })
    ">Deploy WETH</button><br/>
    WETH-Address: <input disabled id="wethAddress">
    <h4>6. Start Balancer Pool</h4>
    Token1 Address: <input type="text" id="token1"> Amount: <input type="text" value="1000000000000000000" id="token1amount"> <br/>
    Token2 Address: <input type="text" id="token2"> Amount: <input type="text" value="1000000000000000000" id="token2amount"> <br/> 
    BPool Address: <input type="text" id="bpool"> <br/> 
    <button onclick="
        CrypTourWeb.startLP(token1amount.value, token1.value, token2amount.value, token2.value, bpool.value)
        .then(res => {
            console.log(res)
        })
        .catch(err => {
            console.log(err)
        })
    ">Start Balancer Pool</button>
    <h4>7. Swap Tokens</h4>
    <button>Swap Tokens</button>
    <h4>8. Consume Dataset</h4>
    <button>Consume Dataset</button>
    <h4>9. Stake LP</h4>
    <button>Stake</button>
    <h4>10. Exit LP</h4>
    <button>Exit</button>

    
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="/web3.min.js"></script>
</body>